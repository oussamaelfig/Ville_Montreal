{% extends "base.html" %}

{% block title %}API Documentation{% endblock %}

{% block content %}
    <div class="container">
        <h1 class="mb-4">Documentation de l'API InspectionMTL</h1>

        <h2 class="mb-3">Endpoints</h2>

        <div class="list-group mb-4">
            <a href="#contrevenants"
               class="list-group-item list-group-item-action">GET
                /api/contrevenants?du=date_debut&au=date_fin</a>
            <a href="#infractions_json"
               class="list-group-item list-group-item-action">GET
                /api/infractions_par_etablissement_json</a>
            <a href="#infractions_xml"
               class="list-group-item list-group-item-action">GET
                /api/infractions_par_etablissement_xml</a>
            <a href="#infractions_csv"
               class="list-group-item list-group-item-action">GET
                /api/infractions_par_etablissement_csv</a>
            <a href="#utilisateurs"
               class="list-group-item list-group-item-action">POST
                /api/utilisateurs</a>
            <a href="#inspection"
               class="list-group-item list-group-item-action">POST
                /api/inspection</a>
        </div>

        <div id="contrevenants" class="card mb-4">
            <div class="card-header">
                <code>GET /api/contrevenants?du=date_debut&au=date_fin</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permet d'obtenir la liste des
                    contrevenants ayant commis au moins une infraction entre
                    deux dates spécifiées en paramètre.</p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>GET /api/contrevenants?du=2022-01-01&au=2022-12-31</code></pre>
                <h4 class="card-title">Exemple de réponse</h4>
                <pre><code>[
    {
        "etablissement": "786 HALAL RESTAURANT",
        "nb_contraventions": 1
    },
    {
        "etablissement": "8449 PROVIGO MONTREAL RACHEL",
        "nb_contraventions": 1
    }
]</code></pre>
            </div>
        </div>

        <div id="infractions_json" class="card mb-4">
            <div class="card-header">
                <code>GET /api/infractions_par_etablissement_json</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permet d'obtenir la liste des
                    établissements ayant commis une ou plusieurs infractions.
                    Pour chaque établissement, on indique le nombre
                    d'infractions connues. La liste est triée en ordre
                    décroissant du nombre d'infractions en format JSON.</p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>GET /api/infractions_par_etablissement_json</code></pre>
                <h4 class="card-title">Exemple de réponse</h4>
                <pre><code>[
    {
        "etablissement": "RESTAURANT BASHA",
        "nb_infractions": 33
    },
    {
        "etablissement": "DOUBLE PIZZA",
        "nb_infractions": 30
    }
]</code></pre>
            </div>
        </div>

        <div id="infractions_xml" class="card mb-4">
            <div class="card-header">
                <code>GET /api/infractions_par_etablissement_xml</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permet d'obtenir d'obtenir la liste des
                    établissements ayant commis une ou plusieurs infractions.
                    Pour chaque établissement, on indique le nombre
                    d'infractions connues. La liste est triée en ordre
                    décroissant du nombre d'infractions en format XML
                </p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>GET /api/infractions_par_etablissement_xml</code></pre>
                <h4 class="card-title">Exemple de réponse</h4>
                <pre><code><etablissements>
                    <etablissement
                            nb_infractions="33">RESTAURANT BASHA</etablissement>
                    <etablissement
                            nb_infractions="30">DOUBLE PIZZA</etablissement>
                    <etablissement
                            nb_infractions="26">BUFFALO BILL WINGS</etablissement>
                </etablissements></code></pre>

            </div>
        </div>

        <div id="infractions_csv" class="card mb-4">
            <div class="card-header">
                <code>GET /api/infractions_par_etablissement_csv</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permet d'obtenir d'obtenir la liste des
                    établissements ayant commis une ou plusieurs infractions.
                    Pour chaque établissement, on indique le nombre
                    d'infractions connues. La liste est triée en ordre
                    décroissant du nombre d'infractions en format CSV
                </p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>GET /api/infractions_par_etablissement_csv</code></pre>
                <h4 class="card-title">Exemple de réponse</h4>
                <pre><code>Etablissement,Nombre d'infractions
                RESTAURANT BASHA,33
                DOUBLE PIZZA,30
                BUFFALO BILL WINGS,26
                </code></pre>

            </div>
        </div>

        <div id="utilisateurs" class="card mb-4">
            <div class="card-header">
                <code>POST /api/utilisateurs</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permettre à un utilisateur de se créer un
                    profil d'utilisateur.</p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>{
    "nom_complet": "Tyrell Wellick",
    "email": "tyrell.wellick@example.com",
    "etablissements_surveilles": ["Etablissement A", "Etablissement B"],
    "mot_de_passe": "password123"
}</code></pre>
                <h4 class="card-title">Exemples de réponses</h4>
                <h5 class="mb-2">Réponse 201 - Utilisateur créé avec
                    succès</h5>
                <pre><code>{
    "message": "Utilisateur créé avec succès"
}</code></pre>
                <h5 class="mb-2">Réponse 400 - L'adresse e-mail est déjà
                    utilisée</h5>
                <pre><code>{
    "erreur": "L'adresse e-mail est déjà utilisée"
}</code></pre>

            </div>
        </div>
        <div id="inspection" class="card mb-4">
            <div class="card-header">
                <code>POST /api/inspection</code>
            </div>
            <div class="card-body">
                <h4 class="card-title">Description</h4>
                <p class="card-text">Permet de faire une demande d'inspection à
                    la ville pour un établissement.</p>
                <h4 class="card-title">Exemple de requête</h4>
                <pre><code>{
                    "nom_etablissement": "Restaurant BASHA",
                    "adresse": "123 Rue Principale",
                    "ville": "Montréal",
                    "date_visite": "2023-03-29",
                    "nom_client": "Oussama Elfigha",
                    "description_probleme": "J'ai trouvé des insectes dans mon plat."
}</code></pre>
                <h4 class="card-title">Exemples de réponses</h4>
                <h5 class="mb-2">Réponse 201 - Demande d'inspection soumise
                    avec succès</h5>
                <pre><code>{
    "message": "Demande d'inspection soumise avec succès"
}</code></pre>
                <h5 class="mb-2">Réponse 400 - Les données fournies sont
                    invalides</h5>
                <pre><code>{
    "erreur": "Les données fournies sont invalides"
}</code></pre>
            </div>
        </div>
    </div>
{% endblock %}
